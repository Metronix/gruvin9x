#summary Notes and links to information about the internals of the '9X hardware
#labels Phase-Design,Featured

See also: The [ReferenceImages Reference Images] wiki page

<img src="http://gruvin9x.googlecode.com/svn/wiki/PCB.attach/schematic_thm.jpg" align="right">

= V2 Schematic =

There exists (in trunk/doc) a PDF circuit schematic, which appears to be from the version 1 radio. Here is link to a V2 schematic, which includes a couple of changes, most notable being the addition of a regulator and voltage-splitter resistor network to drive a 3.3V LCD display.

[http://gruvin9x.googlecode.com/svn/wiki/PCB.attach/gruvin9x_v2_actual.pdf]

= New PCB =

A PCB design has been worked up from scratch in KiCAD to replicate the wiring and function of the V2 '9X hardware. It's closely based on the layout of the original PCB -- especially in terms of component placement. 

== Why? ==

The intention is to start from a near copy of the stock circuit (completed), then make changes to facilitate the freeing up of more I/O ports on the ATmega64 (all of Port B in fact!), with a view to using them for telemetry data acquisition and SD/MMC card mass storage (MISO/MOSI/SCK in SPI mode) -- and possibly to interface to a coffee machine. (OK -- joking on that last bit! :-P) 

Oh and, I also intend installing an ATmega128A to double the Flash program code and EEPROM memory space. (Double the model memory capacity and enough program space to allow for the SD/MMC card FAT file system code library and all the telemetry 'dashboard' plans.) There has been some thought of going even further, to one of the 100 pin ATmega chips with even more EEPROM and SRAM etc. But I'm not sure about the PCB design requirements for that. I don't think it will be needed anyway... but I agree it would be good, IF I can manage it. (I'm only just barely clever enough to do what I've managed so far! :-P) 


== Progress ==

As of this writing, a design covering the stock circuitry, plus just one extra component -- a 10 pin AVR programmer header in the lower right of the board -- has been completed.

== PostScript and PDF Files ==

=== Schematics ===

 * Stock V2 Main PCB - [http://gruvin9x.googlecode.com/svn/trunk/pcb/gruvin9x_v2_actual.pdf PDF] | [http://gruvin9x.googlecode.com/svn/trunk/pcb/gruvin9x_v2_actual.ps PS]
 * Hacked V2 Main PCB - [http://gruvin9x.googlecode.com/svn/trunk/pcb/gruvin9x-hacked.pdf PDF] | [http://gruvin9x.googlecode.com/svn/trunk/pcb/gruvin9x-hacked.ps PS] (Speaker, Fr-Sky telemetry RXD and USART1 freed)


== KiCAD Circuit Schematic and PCB Files ==

Sporadic updates of the _all new_ main PCB schematic and board design in KiCAD are committed to the source repository from time to time. These exist in the `/trunk/pcb/` folder. 

To download all the PCB design related file _without the full source and docs_ coming too ...

{{{
svn checkout http://gruvin9x.googlecode.com/svn/trunk/pcb gruvin9x-pcb
}}}

... or just check out or update the full trunk

... or of course you can use the Google Code 'browse' link above to find them that way.

== Preview ==

2010-12-02: A final draft of the PCB based on [http://gruvin9x.googlecode.com/svn/trunk/pcb/gruvin9x_rev21.pdf schematic rev2.1] has been completed. (All files updated in `/trunk/pcb` as at r159). I'm waiting on some peer review and comments before committing this to a manufacturer. Time frame unknown.

The board includes the total re-wire of all trim and button switches into a 4x4 scanned matrix to free up most of Port B. This gives us I/O ports for the MMC/SDCARD and a couple spares as well. The connector for the SDCARD interface can be seen at lower/middle of the image below. The two connectors to the lower right are the TTL and RS-232 level telemetry TX/RX ports. A 2-pin connector on the upper edge is for the LH and RH trim switch common connections. These replace their respective connections to ground, for the 4x4 matrix mentioned above.

Space will be tight for the SDCARD connector, due to the '9X battery compartment. It should just fit -- plug section and wires included. But if it doesn't, a ribbon cable can be soldered there in place of the connector socket.

This new main board will receive an ATmega2561 (256K Flash, 4K EEPROM, 8K SRAM). I have thus far decided to keep ATmega running at 5V, though it's certainly tempting to move down to 3.3V, since the LCD screen and SDCARD currently need a total of 31 resistors just to down-convert the voltage! However, I'm concerned about possible noise increase on the ADC inputs, should the operating voltage be lowered, and a couple of other minor issues too.

*The 3D image from KiCAD* as at r155 ...

[http://gruvin9x.googlecode.com/svn/wiki/PCB.attach/kicad-pcb-r21-3d-top.jpg]

NOTE: These 3D images do not show the numerous PCB vias included to connect the upper and lower ground planes in a multitude of places. These are in the actual design. (You can see some in the PhotoShop mock-up image below.) The vias are important to eliminate capacitive effects and possible RF pick-up around 2.4GHz. 

=== Previously ===

NOTE: These images (below) as at r122 ...

[http://gruvin9x.googlecode.com/svn/wiki/PCB.attach/PCB-final-mock.jpg]

The above image is merely a PhotoShop mock-up based on the various layer outputs from KiCAD. 

=== Cost ===

The present best quote for low volume PCB manufacture is around the USD$15 mark -- for one of 10 boards with no components installed. Manufacturing of a prototype board will likely not happen until at least the telemetry and mass storage mods have been done. That will include break-outs for any remaining spare port pins and should get the hardware to a point where nothing additional is needed. 

[http://gruvin9x.googlecode.com/svn/wiki/PCB.attach/kicad-pcb-3d-top.jpg]

[http://gruvin9x.googlecode.com/svn/wiki/PCB.attach/kicad-pcb-3d-bottom.jpg]